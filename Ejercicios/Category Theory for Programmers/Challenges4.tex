\documentclass[11pt]{article}
%Gummi|065|=)
\usepackage[utf8x]{inputenc}
\usepackage[margin=1in]{geometry} 
\usepackage{amsmath,amsthm,amssymb}
\usepackage[spanish]{babel}
\usepackage{mathpazo}
\usepackage{tikz}
\usepackage{tikz-cd}
\usetikzlibrary{babel}
\SetUnicodeOption{mathletters}
\SetUnicodeOption{autogenerated}
\setlength\parindent{0pt}

\usepackage{listings}
\usepackage{xcolor}
\lstset { %
    language=C++,
    backgroundcolor=\color{black!5},
    basicstyle=\footnotesize,
}

\begin{document}
\begin{enumerate}
\item \textit{Construct the Kleisli category for partial functions (define composition and identity).}

\begin{lstlisting}
template <class A>
optional<A> returnOpt(A a) {
	return optional<A>{a};
}

auto const compose = [](auto o1, auto o2) {
	return [o1,o2](auto a) {
		auto b = o1(a);
		return b.isValid() ? o2(b.value())
			: optional<decltype(o2(b.value()).value())>{};
	};
};
\end{lstlisting}

\item \textit{Implement the embellished function \texttt{safe\_reciprocal} that returns a valid reciprocal of its argument, if it's different from zero.}

\begin{lstlisting}
optional<double> safe_reciprocal(double a) {
	return a == 0 ? optional<double>{} : optional<double>{1/a};
}
\end{lstlisting}

\item \textit{Compose \texttt{safe\_root} and \texttt{safe\_reciprocal} to implement \texttt{safe\_root\_reciprocal} that calculates \texttt{sqrt(1/x)} whenever possible.}
\begin{lstlisting}
optional<double> safe_root_reciprocal(double a) {
	return compose(safe_root, safe_reciprocal)(a);
}
\end{lstlisting}
\end{enumerate}
\end{document}
